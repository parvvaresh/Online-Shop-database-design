\documentclass[12pt]{article}
\input{etc/cmd}

\begin{document}
\fontsize{12pt}{14pt}\selectfont

\input{etc/head}

% \maketitle

\renewcommand{\abstractname}{طراحی پایگاه داده فروشگاه آنلاین}
\begin{abstract}
در ادامه ساختار پایگاه داده یک فروشگاه آنلاین جامع شرح داده شده است. این پایگاه داده از قابلیت‌هایی مانند مدیریت کاربران، مدیریت محصولات، مدیریت سفارشات، سیستم پیام‌رسانی بین کاربران و مدیران، سیستم سبد خرید، تاریخچه خرید، اطلاعات بانکی، سیستم پیشنهادات، نظرات کاربران، لیست علاقه‌مندی‌ها، اطلاعات حمل و نقل، تخفیفات و ترجیحات کاربران پشتیبانی می‌کند.
\end{abstract}

\section{جداول پایگاه داده}

\subsection{ \(Users\)}

\textbf{توضیحات:} اطلاعات مربوط به کاربران فروشگاه آنلاین را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{user\_id}: شناسه‌ی منحصر به فرد برای هر کاربر.
    \item \texttt{username}: نام کاربری انتخاب شده توسط کاربر، منحصر به فرد در سیستم.
    \item \texttt{password}: رمز عبور رمزگذاری شده کاربر.
    \item \texttt{email}: آدرس ایمیل کاربر، منحصر به فرد در سیستم.
    \item \texttt{first\_name}: نام کوچک کاربر.
    \item \texttt{last\_name}: نام خانوادگی کاربر.
    \item \texttt{phone}: شماره تماس کاربر.
    \item \texttt{address}: آدرس فیزیکی کاربر برای اهداف ارسال.
    \item \texttt{created\_at}: زمان ایجاد حساب کاربری.
    \item \texttt{updated\_at}: زمان آخرین به‌روزرسانی حساب کاربری.
\end{itemize}

\subsection{\(Admins\)}

\textbf{توضیحات:} اطلاعات مربوط به مدیران فروشگاه آنلاین را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{admin\_id}: شناسه‌ی منحصر به فرد برای هر مدیر.
    \item \texttt{username}: نام کاربری انتخاب شده توسط مدیر، منحصر به فرد در سیستم.
    \item \texttt{password}: رمز عبور رمزگذاری شده مدیر.
    \item \texttt{email}: آدرس ایمیل مدیر، منحصر به فرد در سیستم.
    \item \texttt{created\_at}: زمان ایجاد حساب مدیر.
    \item \texttt{updated\_at}: زمان آخرین به‌روزرسانی حساب مدیر.
\end{itemize}

\subsection{\(Products\)}

\textbf{توضیحات:} اطلاعات مربوط به محصولات موجود در فروشگاه آنلاین را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{product\_id}: شناسه‌ی منحصر به فرد برای هر محصول.
    \item \texttt{name}: نام محصول.
    \item \texttt{description}: توضیحات دقیق محصول.
    \item \texttt{price}: قیمت محصول.
    \item \texttt{stock}: تعداد محصول موجود در انبار.
    \item \texttt{category\_id}: شناسه دسته‌بندی که محصول به آن تعلق دارد.
    \item \texttt{brand\_id}: شناسه برند محصول.
    \item \texttt{created\_at}: زمان اضافه شدن محصول به سیستم.
    \item \texttt{updated\_at}: زمان آخرین به‌روزرسانی اطلاعات محصول.
\end{itemize}

\subsection{\(Categories\)}

\textbf{توضیحات:} دسته‌بندی محصولات را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{category\_id}: شناسه‌ی منحصر به فرد برای هر دسته‌بندی.
    \item \texttt{name}: نام دسته‌بندی.
    \item \texttt{description}: توضیحات دسته‌بندی.
\end{itemize}

\subsection{\(Brands\)}

\textbf{توضیحات:} اطلاعات مربوط به برندهای محصولات را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{brand\_id}: شناسه‌ی منحصر به فرد برای هر برند.
    \item \texttt{name}: نام برند.
    \item \texttt{description}: توضیحات برند.
\end{itemize}

\subsection{\(Orders\)}

\textbf{توضیحات:} اطلاعات مربوط به سفارشات ثبت شده توسط کاربران را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{order\_id}: شناسه‌ی منحصر به فرد برای هر سفارش.
    \item \texttt{user\_id}: شناسه کاربری که سفارش را ثبت کرده است.
    \item \texttt{order\_date}: تاریخ و زمان ثبت سفارش.
    \item \texttt{status}: وضعیت فعلی سفارش (مثلاً در حال پردازش، ارسال شده، تحویل داده شده).
    \item \texttt{total\_amount}: مبلغ کل سفارش.
    \item \texttt{payment\_method}: روش پرداخت (مثلاً کارت اعتباری، پی‌پال).
    \item \texttt{shipping\_address}: آدرس ارسال سفارش.
\end{itemize}

\subsection{\(Order-Details\)}

\textbf{توضیحات:} اطلاعات دقیق هر سفارش را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{order\_detail\_id}: شناسه‌ی منحصر به فرد برای هر جزئیات سفارش.
    \item \texttt{order\_id}: شناسه سفارش که این جزئیات به آن تعلق دارد.
    \item \texttt{product\_id}: شناسه محصول در سفارش.
    \item \texttt{quantity}: تعداد محصول سفارش داده شده.
    \item \texttt{price}: قیمت محصول در زمان سفارش.
\end{itemize}

\subsection{\(Cart\)}

\textbf{توضیحات:} اطلاعات مربوط به اقلام موجود در سبد خرید کاربران را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{cart\_id}: شناسه‌ی منحصر به فرد برای هر سبد خرید.
    \item \texttt{user\_id}: شناسه کاربری که صاحب سبد خرید است.
    \item \texttt{created\_at}: زمان ایجاد سبد خرید.
    \item \texttt{updated\_at}: زمان آخرین به‌روزرسانی سبد خرید.
\end{itemize}

\subsection{\(Cart-Items\)}

\textbf{توضیحات:} اطلاعات دقیق هر آیتم در سبد خرید را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{cart\_item\_id}: شناسه‌ی منحصر به فرد برای هر آیتم سبد خرید.
    \item \texttt{cart\_id}: شناسه سبد خرید که این آیتم به آن تعلق دارد.
    \item \texttt{product\_id}: شناسه محصول در سبد خرید.
    \item \texttt{quantity}: تعداد محصول در سبد خرید.
    \item \texttt{price}: قیمت محصول در زمان اضافه شدن به سبد خرید.
\end{itemize}

\subsection{\(Purchase-History\)}

\textbf{توضیحات:} تاریخچه خرید کاربران را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{history\_id}: شناسه‌ی منحصر به فرد برای هر تاریخچه خرید.
    \item \texttt{user\_id}: شناسه کاربری که خرید را انجام داده است.
    \item \texttt{order\_id}: شناسه سفارشی که بخشی از تاریخچه خرید است.
    \item \texttt{purchase\_date}: تاریخ و زمان خرید.
    \item \texttt{total\_amount}: مبلغ کل خرید.
\end{itemize}

\subsection{\(Reviews\)}

\textbf{توضیحات:} نظرات کاربران در مورد محصولات را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{review\_id}: شناسه‌ی منحصر به فرد برای هر نظر.
    \item \texttt{user\_id}: شناسه کاربری که نظر را نوشته است.
    \item \texttt{product\_id}: شناسه محصولی که نظر در مورد آن است.
    \item \texttt{rating}: امتیاز داده شده توسط کاربر (مثلاً 1 تا 5 ستاره).
    \item \texttt{review}: متن نظر.
    \item \texttt{review\_date}: تاریخ و زمان ثبت نظر.
\end{itemize}

\subsection{\(Shipping-Information\)}

\textbf{توضیحات:} اطلاعات حمل و نقل سفارشات را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{shipping\_id}: شناسه‌ی منحصر به فرد برای هر اطلاعات حمل و نقل.
    \item \texttt{order\_id}: شناسه سفارشی که این اطلاعات حمل و نقل به آن تعلق دارد.
    \item \texttt{tracking\_number}: شماره پیگیری ارائه شده توسط حامل.
    \item \texttt{carrier}: حامل حمل و نقل (مثلاً UPS، FedEx).
    \item \texttt{shipping\_date}: تاریخ و زمان ارسال سفارش.
    \item \texttt{delivery\_date}: تاریخ و زمان تحویل سفارش.
    \item \texttt{status}: وضعیت فعلی حمل و نقل (مثلاً در حال ارسال، تحویل داده شده).
\end{itemize}

\subsection{\(Promotions\)}

\textbf{توضیحات:} اطلاعات مربوط به تخفیفات و پیشنهادات ویژه را ذخیره می‌کند.

\textbf{ستون‌ها:}
\begin{itemize}
    \item \texttt{promotion\_id}: شناسه‌ی منحصر به فرد برای هر تخفیف.
    \item \texttt{code}: کد تخفیف منحصر به فرد.
    \item \texttt{description}: توضیحات تخفیف.
    \item \texttt{discount\_percentage}: درصد تخفیف ارائه شده.
    \item \texttt{start\_date}: تاریخ و زمان شروع تخفیف.
    \item \texttt{end\_date}: تاریخ و زمان پایان تخفیف.
\end{itemize}

\section{کوئری های رایج}

\subsection{کوئری مدیریت کاربران}

\begin{enumerate}
    \item \textbf{بازیابی همه کاربران:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Users;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{یافتن کاربر با نام کاربری:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Users WHERE username = ?;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{به‌روزرسانی اطلاعات کاربر:}
    \begin{latin}
    \begin{verbatim}
    UPDATE Users
    SET email = ?, first_name = ?, last_name = ?, phone = ?, address = ?,
    updated_at = NOW() WHERE user_id = ?;
    \end{verbatim}
    \end{latin}
\end{enumerate}

\subsection{کوئری مدیریت محصولات}

\begin{enumerate}
    \item \textbf{بازیابی همه محصولات:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Products;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{یافتن محصولات بر اساس دسته‌بندی:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Products WHERE category_id = ?;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{یافتن محصولات بر اساس برند:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Products WHERE brand_id = ?;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{به‌روزرسانی موجودی محصول:}
    \begin{latin}
    \begin{verbatim}
    UPDATE Products
    SET stock = ?, updated_at = NOW()
    WHERE product_id = ?;
    \end{verbatim}
    \end{latin}
\end{enumerate}

\subsection{کوئری مدیریت سفارشات}

\begin{enumerate}
    \item \textbf{بازیابی همه سفارشات برای یک کاربر:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Orders WHERE user_id = ?;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{یافتن جزئیات سفارش با شناسه سفارش:}
    \begin{latin}
    \begin{verbatim}
    SELECT od.*, p.name, p.description
    FROM Order_Details od
    JOIN Products p ON od.product_id = p.product_id
    WHERE od.order_id = ?;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{به‌روزرسانی وضعیت سفارش:}
    \begin{latin}
    \begin{verbatim}
    UPDATE Orders
    SET status = ?, updated_at = NOW()
    WHERE order_id = ?;
    \end{verbatim}
    \end{latin}
\end{enumerate}

\subsection{کوئری مدیریت سبد خرید}

\begin{enumerate}
    \item \textbf{بازیابی سبد خرید کاربر:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Cart WHERE user_id = ?;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{بازیابی اقلام موجود در سبد خرید کاربر:}
    \begin{latin}
    \begin{verbatim}
    SELECT ci.*, p.name, p.price
    FROM Cart_Items ci
    JOIN Products p ON ci.product_id = p.product_id
    WHERE ci.cart_id = (SELECT cart_id FROM Cart WHERE user_id = ?);
    \end{verbatim}
    \end{latin}
    
    \item \textbf{افزودن آیتم به سبد خرید:}
    \begin{latin}
    \begin{verbatim}
    INSERT INTO Cart_Items (cart_id, product_id, quantity, price)
    VALUES (?, ?, ?, ?);
    \end{verbatim}
    \end{latin}
\end{enumerate}

\subsection{کوئری سیستم پیام‌رسانی}

\begin{enumerate}
    \item \textbf{بازیابی پیام‌ها برای یک کاربر:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Messages WHERE receiver_id = ? OR sender_id = ?;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{ارسال پیام:}
    \begin{latin}
    \begin{verbatim}
    INSERT INTO Messages (sender_id, receiver_id, content, sent_at)
    VALUES (?, ?, ?, NOW());
    \end{verbatim}
    \end{latin}
\end{enumerate}

\subsection{کوئری نظرات و امتیازات}

\begin{enumerate}
    \item \textbf{بازیابی نظرات برای یک محصول:}
    \begin{latin}
    \begin{verbatim}
    SELECT r.*, u.username
    FROM Reviews r
    JOIN Users u ON r.user_id = u.user_id
    WHERE r.product_id = ?;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{افزودن نظر:}
    \begin{latin}
    \begin{verbatim}
    INSERT INTO Reviews (user_id, product_id, rating, review, review_date)
    VALUES (?, ?, ?, ?, NOW());
    \end{verbatim}
    \end{latin}
\end{enumerate}

\subsection{کوئری لیست علاقه‌مندی‌ها}

\begin{enumerate}
    \item \textbf{بازیابی لیست علاقه‌مندی برای یک کاربر:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Wishlists WHERE user_id = ?;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{بازیابی آیتم‌های موجود در لیست علاقه‌مندی‌های کاربر:}
    \begin{latin}
    \begin{verbatim}
    SELECT wi.*, p.name, p.price
    FROM Wishlist_Items wi
    JOIN Products p ON wi.product_id = p.product_id
    WHERE wi.wishlist_id = (SELECT wishlist_id FROM Wishlists WHERE user_id = ?);
    \end{verbatim}
    \end{latin}
    
    \item \textbf{افزودن آیتم به لیست علاقه‌مندی‌ها:}
    \begin{latin}
    \begin{verbatim}
    INSERT INTO Wishlist_Items (wishlist_id, product_id, added_at)
    VALUES (?, ?, NOW());
    \end{verbatim}
    \end{latin}
\end{enumerate}

\subsection{کوئری اطلاعات حمل و نقل}

\begin{enumerate}
    \item \textbf{بازیابی اطلاعات حمل و نقل برای یک سفارش:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Shipping_Information WHERE order_id = ?;
    \end{verbatim}
    \end{latin}
    
    \item \textbf{به‌روزرسانی وضعیت حمل و نقل:}
    \begin{latin}
    \begin{verbatim}
    UPDATE Shipping_Information
    SET status = ?, updated_at = NOW()
    WHERE shipping_id = ?;
    \end{verbatim}
    \end{latin}
\end{enumerate}

\subsection{کوئری تخفیف‌ها}

\begin{enumerate}
    \item \textbf{بازیابی همه تخفیفات فعال:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Promotions WHERE start_date <= NOW() AND end_date >= NOW();
    \end{verbatim}
    \end{latin}
    
    \item \textbf{اعمال کد تخفیف به یک سفارش:}
    \begin{latin}
    \begin{verbatim}
    SELECT * FROM Promotions WHERE code = ? 
    AND start_date <= NOW() AND end_date >= NOW();
    \end{verbatim}
    \end{latin}
\end{enumerate}

\subsection{کوئری پیشنهادات}

\begin{enumerate}
    \item \textbf{بازیابی پیشنهادات برای یک کاربر:}
    \begin{latin}
    \begin{verbatim}
    SELECT p.*
    FROM Recommendations r
    JOIN Products p ON r.product_id = p.product_id
    WHERE r.user_id = ?;
    \end{verbatim}
    \end{latin}
\end{enumerate}

\end{document}